using MultiPrecision;
using System.Collections.ObjectModel;
using System.Numerics;

namespace LandauBasicFunctionCache {
    public static class LogCache<N> where N : struct, IConstant {
        static readonly Log1pCacheTable<N> cache = new();

        static LogCache() {
            if (default(N).Value > 20) {
                throw new ArgumentOutOfRangeException("N");
            }
        }

        public static MultiPrecision<N> Log(MultiPrecision<N> x) {
            return Log2(x) * MultiPrecision<N>.Ln2;
        }

        public static MultiPrecision<N> Log2(MultiPrecision<N> x) {
            if (MultiPrecision<N>.IsNegative(x) || MultiPrecision<N>.IsNaN(x)) {
                return MultiPrecision<N>.NaN;
            }
            if (MultiPrecision<N>.IsZero(x)) {
                return MultiPrecision<N>.NegativeInfinity;
            }

            long exponent = x.Exponent;
            MultiPrecision<N> f = MultiPrecision<N>.Ldexp(x, -exponent), fm1 = f - 1;

            (MultiPrecision<N> log2_l0, _, MultiPrecision<N> f_x0, _) = cache.Value(fm1);
            MultiPrecision<N> f_l0m1 = f / (f_x0 + 1) - 1;

            MultiPrecision<N> log2_l1 = Log1pPadeApprox<N>.Log1pC32(f_l0m1);

            MultiPrecision<N> log = (log2_l0 + log2_l1) * MultiPrecision<N>.LbE + exponent;

            return log;
        }
    }

    internal class Log1pCacheTable<N> : CacheTable<N, MultiPrecision<N>> where N : struct, IConstant {
        public Log1pCacheTable() : base(xmax_exponent: 0, n: 4096) { }

        public override MultiPrecision<N> Compute(MultiPrecision<N> x) {
            return Log1pPadeApprox<N>.Log1pC128(x);
        }
    }

    public static class Log1pPadeApprox<N> where N : struct, IConstant {
        private static readonly ReadOnlyCollection<MultiPrecision<N>> n32 = new ReadOnlyCollection<MultiPrecision<N>>(
            new MultiPrecision<N>[] {
                BigInteger.Parse("132318718535345816768737834591200"),
                BigInteger.Parse("2017335383384121539783693494045200"),
                BigInteger.Parse("14628569438074343076099349490916000"),
                BigInteger.Parse("67136855336540613248428177351777800"),
                BigInteger.Parse("218912956502461572787698468273107040"),
                BigInteger.Parse("539698923669583462540046764561648560"),
                BigInteger.Parse("1045290384654570200725047053206221600"),
                BigInteger.Parse("1631459432114944011797819792092402500"),
                BigInteger.Parse("2088496919606284362752641990889964000"),
                BigInteger.Parse("2220444353724881585258634808230699600"),
                BigInteger.Parse("1978085872800475228808063058086474400"),
                BigInteger.Parse("1485645471077527171563779638657647000"),
                BigInteger.Parse("944444414082791781833112682047420000"),
                BigInteger.Parse("509296026991570456908768503901865200"),
                BigInteger.Parse("233102527606128927516184092874885920"),
                BigInteger.Parse("90472158815318958662666797541586930"),
                BigInteger.Parse("29706788511156341570122869902200800"),
                BigInteger.Parse("8220669540655496024258148792186000"),
                BigInteger.Parse("1906845600022305555047888295242400"),
                BigInteger.Parse("368087130289556679416417224283880"),
                BigInteger.Parse("58583669637221654845766817690720"),
                BigInteger.Parse("7597322000606652199645603786800"),
                BigInteger.Parse("790848185475074349671040564000"),
                BigInteger.Parse("64829593499268840691958952300"),
                BigInteger.Parse("4082958127724480359740953568"),
                BigInteger.Parse("191222384251040252118428112"),
                BigInteger.Parse("6370485575495913413166240"),
                BigInteger.Parse("141692475450520734724600"),
                BigInteger.Parse("1909572046684479043680"),
                BigInteger.Parse("13202441206671521904"),
                BigInteger.Parse("32742594794360096"),
                BigInteger.Parse("4512611027925"),
                BigInteger.Parse("132318718535345816768737834591200"),
                BigInteger.Parse("2083494742651794448168062411340800"),
                BigInteger.Parse("15626210569888458361260468085056000"),
                BigInteger.Parse("74288542053568080733861241715840000"),
                BigInteger.Parse("251342900614572006482897201138592000"),
                BigInteger.Parse("644119433439377752207017912070425600"),
                BigInteger.Parse("1299344374351848224279674064004134400"),
                BigInteger.Parse("2116726424382710139803980304768640000"),
                BigInteger.Parse("2834901461226843937237473622458000000"),
                BigInteger.Parse("3161344659792359299707243312316800000"),
                BigInteger.Parse("2962297033064692232688639103763520000"),
                BigInteger.Parse("2347480667711642901375902686001280000"),
                BigInteger.Parse("1580035064805913491310703730962400000"),
                BigInteger.Parse("905600791291473795924686904624000000"),
                BigInteger.Parse("442450672316691483151775601973440000"),
                BigInteger.Parse("184203953372663392985637189393024000"),
                BigInteger.Parse("65238900152818285015746504576696000"),
                BigInteger.Parse("19596165252410999253791190360960000"),
                BigInteger.Parse("4970041911843369375961533787200000"),
                BigInteger.Parse("1057950442053208451959063332480000"),
                BigInteger.Parse("187545760182159680120015772576000"),
                BigInteger.Parse("27415327069817361878008950144000"),
                BigInteger.Parse("3263729413073495461667732160000"),
                BigInteger.Parse("311490612064278463997980800000"),
                BigInteger.Parse("23361795904820884799848560000"),
                BigInteger.Parse("1341805713507661075683609600"),
                BigInteger.Parse("57040323853564539654566400"),
                BigInteger.Parse("1712922638245181371008000"),
                BigInteger.Parse("33986560282642487520000"),
                BigInteger.Parse("401811550139615616000"),
                BigInteger.Parse("2363597353762444800"),
                BigInteger.Parse("4620913692595200"),
            }
        );

        private static readonly ReadOnlyCollection<MultiPrecision<N>> n128 = new ReadOnlyCollection<MultiPrecision<N>>(
            new MultiPrecision<N>[] {
                BigInteger.Parse("38516631450260400525535211315498342335386604779997217684530295319307159303730348323765465398634998010522717296836706943829383440000"),
                BigInteger.Parse("2436139177825587725004292767458882409240324922330137746764497521793903995412607540940593367379939472206728023223650305660989062008000"),
                BigInteger.Parse("76130161177222342483454049970387411773427027167917559429704486184833387213433230950951347590923177773575178410466407335434626160048000"),
                BigInteger.Parse("1567121940758395132594320707661674231540475070986843411623591380860561229012069145703595088522674002921319426404535501119223179373500000"),
                BigInteger.Parse("23902521040203672007942352865577588970346758307354527014253132977794620722728800295364736981332802941802933104082906651245028157224400000"),
                BigInteger.Parse("288110004572997666378204702469511657871256655338324692399571783821171157822103567798220424425523289430641865952150566585040053487944897600"),
                BigInteger.Parse("2858411077934829614262201498828815873013426316038809223561771604188541242781805441496571142782882484307330700384716979600401191934997718400"),
                BigInteger.Parse("24006317594765361148513547039001805305242263091645023632722687902028058729697695028830918571146722808962544622073551628957805254083735902000"),
                BigInteger.Parse("174206030896344009742941655720966990869782099759363826871752338602304906458678407254717522938163077271585084281291351094874386689136856720000"),
                BigInteger.Parse("1109490284198606485998098558694526799883314238894814899532671665702020509384893597347235970754614251088503660824188072292655168487070993944000"),
                BigInteger.Parse("6278371937546927151816396817759307988323101371482541823857694263592611492731115818024462213913293638451608926282466925495421421459346484835200"),
                BigInteger.Parse("31881820741604862035615953347093125436986424354194919981627181979266513497617158261138161079795555741201109254890368157607904303757343850464800"),
                BigInteger.Parse("146473597167030026638598374123285936704872017141157445373740607079619137006086480876230320516722376752458228436958506172893549992932101658448000"),
                BigInteger.Parse("613005872795560894076759897188761225382761249526830970919937796923287966894628403775614262532403406581213863357057892853011300280805582511560000"),
                BigInteger.Parse("2350594799808251038929413244156381767798649301118317820647405296903609014207926688540096854201794263319472676470157009823732681950151170381808000"),
                BigInteger.Parse("8299663363036794652240590223884066550409430125763389543856239324427209667100609254364259539580515316294510776935469110647675586387645522895042200"),
                BigInteger.Parse("27101066461601290607935434663510039184843737982793710056495752561209687775709142988877461309590887249788871736140838163857297470097355195178460800"),
                BigInteger.Parse("82147287081318308921992034015459060574505452565770992858159947187688567675574447289968270457744710904229064194596768197474913784199594507300152000"),
                BigInteger.Parse("231911947513952732098145471498540039684920654649601940757726733097582168375761440740813787018225813519977312783926356118382772457792033537290160000"),
                BigInteger.Parse("611581141269025905873041554373515837454341465885851970522585995168381399195591167537649005990393327161709466104144461380117441748888971712163916000"),
                BigInteger.Parse("1510515082710756312787990433522347767677744792675860563638426569727250044692161304043384981069225192617646237616136486882046209377665334995540841600"),
                BigInteger.Parse("3502322295360799789649120718175898499090914810874216709965522748881768038501889846804241082665184923719076877235549161545703189115174708402956366400"),
                BigInteger.Parse("7639496365374156801045022493843168329802631995200149388775672745348284133530892012656667617463999285556773762416471029721590651320878833694452848000"),
                BigInteger.Parse("15706498426105913027396465554593147907377325957598070521826369901959791273965403440150472315405856248927232967113726578077888480252420112642219370000"),
                BigInteger.Parse("30489520319131284016129424794911661029567873282332243220710486275971302136795790238547085544391158141079470730453460099938989192295549699074679849600"),
                BigInteger.Parse("55970649165958486144562662351365186173691545162349627230894391707150988120932136678944839416402745013394504061765283074192536897540180264007534941120"),
                BigInteger.Parse("97303816439096111055162371797480093588370643483794617890265474288785572634389637576471501268515218475060988957002089781597283672248568277721173009280"),
                BigInteger.Parse("160408125453555901332663699032908800366772180431318883220948032559730738669045969745572050857018071257055889202669737472882887101382484562618091812000"),
                BigInteger.Parse("251054848177504857055127374589646284541955740404823728411990730600462747241378764202071357407309376156252312956027851927458715468802947671212619600000"),
                BigInteger.Parse("373449531087699640166051393013088333564279733771850756328828518806823536258548626858143955568467544899424717808571794040902501808870774862632149640000"),
                BigInteger.Parse("528508870080399922998760150750396336080069621075669213551735865090483206003964658158751472341977448447802162217032972292170960528714168378683287638400"),
                BigInteger.Parse("712246042409933875835218512283649053007374526462299026904139186139526663768378117869451658227971853260840023579984808884378854260272824869679978073100"),
                BigInteger.Parse("914814577283273853190128743120017288004543207077324614158526351906084476993531040558998586320851593485777081897051200986630389810462086567194814608000"),
                BigInteger.Parse("1120726219914432138082065004953440313088573305199066419104685240442082798367373384095354249728313483931784470915412525506874083373806064091676436280000"),
                BigInteger.Parse("1310509865719055409889232402289051940562706939428149575448595759116193231714428335734333759533619822137754786088491350981838798843019372632767853616000"),
                BigInteger.Parse("1463663046140335912265758962858275431548106849041170701631693221299132716309543793633974715499950025770410953975921484702525337830365704251912728648800"),
                BigInteger.Parse("1562300137445476444196807972488215797441648324077478999076017874677194735167215705632369470544930572461373327308781174128188137648520134535879047811200"),
                BigInteger.Parse("1594598334095613962211278109934330338280093049127996787445189814328335314696395130677345703889280038209170160419226748860294978199111386037747282792000"),
                BigInteger.Parse("1557121291685762517259028799703085935784741001900637848034174035052793304470131964925612409794148119625118518991885412704697683758191615847209561840000"),
                BigInteger.Parse("1455391844764151886823396374537349356890212801123933607495060008599972425775328721372571553133404602292440234186050049674655778850712614928322070742000"),
                BigInteger.Parse("1302591500747929361042349854847366387971791909667413061311066847092945460667098797442350826779257974010756372211286625907283060840430859668668597980800"),
                BigInteger.Parse("1116799596532329262521592656936529792127132924514816120304130796123809593603547223473146307853873717540710182809483992803230427260238773914140636171200"),
                BigInteger.Parse("917557382944453572221570145721029913635450841353296060599890180445949869606370615377775771278972371938939210161062386349867296768733237255332914608000"),
                BigInteger.Parse("722636141511366691147348891140738528758070071952834191587217629246009358032726857375842929938273054411291276908627773779025166579795720467969707540000"),
                BigInteger.Parse("545705102892194127548203217769212281773024540095439314173962826161200110484582545500658996462459331923168777197801074832660025024277857861917295824000"),
                BigInteger.Parse("395237635958827376576909546327471684801710059921248776847543981114380283635882792460635587877492529643481066505120381381952323094473995698844078958400"),
                BigInteger.Parse("274610898243436071080317563284718247281675595341811149742167381390724421789633598526565251303207220434891644138221197914852553436699529072288751113600"),
                BigInteger.Parse("183071791361303656277819857495122983544562997773075705345597853248972555373138039995628493157064843788460925204065656376145141036061430304154787517000"),
                BigInteger.Parse("117123075844623892221373693959675314810663322740903935090920861331189883720837157496791073094899355676405013261658700243945420851891933834952808080000"),
                BigInteger.Parse("71918841730006869253091249655530222734787925941123540065941342541377133743053034333603543188370548534446414119263147489631339769127283108292903723200"),
                BigInteger.Parse("42390921218344392280652638128853531243125579469520501822271648360193081836689278699247459596876680380474558786956550684670387221367098343863691066240"),
                BigInteger.Parse("23986840722079713677111745246370655758762373173584460569371192145156868320392794161167555166715600917472230568436424314625021332377459651761015502560"),
                BigInteger.Parse("13030855105223913952460755179376060658514428151963125827744125355024587903246296104004317676432611813394359184562536764372028965520428852802875728000"),
                BigInteger.Parse("6796602863508742595743991244465091448729000375495775255210068898972008581424023730091856564207525649257312072273666554315082743622641249305557800000"),
                BigInteger.Parse("3403607228655227325385755037103950754228054167754776127545463879938390572619523948389697405074754152087288939595624876397912379548709160752903920000"),
                BigInteger.Parse("1636496816547186788890678342346913871842084404292224999243352771522973084744942586904519887981255181422144674330810008325080098856667185604533339600"),
                BigInteger.Parse("755455688357155726505451554317181589439077846207686879354853725953747697111600485359947610107358330930623653219796975418888447788025818543661686400"),
                BigInteger.Parse("334812179540411238577030998090140318593626172612652538103510419736945301996656879562165827519222833344609986863040660126666472940643017246319512000"),
                BigInteger.Parse("142450083488386412250798792124005578742455231512676878884304804976646699496083679049245366298880022594185995399381325196016447900501373304409520000"),
                BigInteger.Parse("58177448353619419024396559435072696266961577672965484457274885142948476132568737476404582028872055586219199487882561641032112436487378016642084000"),
                BigInteger.Parse("22804940462643322698922851872362331761001610270111334038926873067207366438942132975892713567108906151909832194883854687143852426499937833272835200"),
                BigInteger.Parse("8578825606136350296195840800545689711502543970121111856911691616626452420338951079473735323577846733320086870620095123650016887013675842481044800"),
                BigInteger.Parse("3096592971505522904526060227836736429091602129761295404697475021220570515350325567322131843101008922140233664590500841494012720811927747455088000"),
                BigInteger.Parse("1072311440307445627096005029031657056892200622849853290035875240981686724251090654214773101630346942456188950936280869961805186395345084195253750"),
                BigInteger.Parse("356165383255607132327545360187372631988210365493184531281770783333671513834898298903788842758661349054817888487415183480118406513713438963728000"),
                BigInteger.Parse("113443597792380318126494239902038507685382610337715134919786599299425986909565268021771710506266791374892410212465137384786411268888463914539200"),
                BigInteger.Parse("34641711708371206712151011796387468088807404608641601387514521719190349561345076727768943917848627863051324121268752271519355294658496020348800"),
                BigInteger.Parse("10138952897596215088789092739433201743851303495899730777824117565450754944733557192161723858286640341875815842789046548888131314034391198012000"),
                BigInteger.Parse("2843375346045287514773837994054480351251845266756815174401176918811150885565384933685849510373869733110144367169123402301826554250100222160000"),
                BigInteger.Parse("763809119421330403635127544709288393308054336890281857805968998354787005696464919252227923794092358964606698751339816365668121511889163176000"),
                BigInteger.Parse("196470026416344460929732074206954948326273121977813563430483698292900306320027219180375521831178666492761380604459262882874441788774021385600"),
                BigInteger.Parse("48373615826077660343152836195290654586930056739765487330173270700649444732878326409987088575153153099705103651054171979655261953299817332400"),
                BigInteger.Parse("11395933055598644680080719237606956947873018312154161975427391059009198520493397944351570275333672358531869050535295345240454134537817488000"),
                BigInteger.Parse("2567654378851822298988357638614925050086058290140252012475443619296935500119077512323260007070346850179435195222594860933897955434266520000"),
                BigInteger.Parse("553060088091332536420932470200055388559112167905451567014897745339940514694778470028144454816204320512059062283948622991894759559486307200"),
                BigInteger.Parse("113827682532152248580567174005778244381743485801470882409260703709838507310817460341771354262848730874584370710381761111629821553155102240"),
                BigInteger.Parse("22373838331264592851484903275830562294287993636188320201306307145013236007493473678043433113603919876629403387464709194153051326406674560"),
                BigInteger.Parse("4197717361475843571191184299356816618536698862404367708973069469453477131176489023939796127504110157584578262181343845693132555253832000"),
                BigInteger.Parse("751301523046326000239880502315779039223993193247863808486288270467442081307587683387150967136775933843353113525012753161666042050800000"),
                BigInteger.Parse("128196597363320425970020136922044465833204558636934829608825902129919170954403692596895817293621764400461533951699239259893350169395000"),
                BigInteger.Parse("20840894824938757797993168685603158669633953859475141455747280149606129339559479362329656654161864291756103189292180474496473878134400"),
                BigInteger.Parse("3225768408327831718222672920669739672544762964443322878613508288054836910903550570875638734047813054416827674910695885339947222609600"),
                BigInteger.Parse("475015939520798145274269966835585701066688023920447362481706004501079351904568805912472130742590421998910614050014869838838879408000"),
                BigInteger.Parse("66497210528188556351919424096366706812777960437192024385552350676486908849752867880304749462115066096296172853128526249829605580000"),
                BigInteger.Parse("8842207365769633914237196103742308945478416084061284160306391087986507902399555552453955224229921492502709307869777114232409296000"),
                BigInteger.Parse("1115835599728948786222544940927120529890234670848712472243923869131915185830537645314877564550555285651589461179969478307350324800"),
                BigInteger.Parse("133511681956898778303681116426948093698941989482503714771652545681299837894003382145858622576099800564466751181937931413870755200"),
                BigInteger.Parse("15131802938555360012553633586292992769984473481711883653785964951531561569343550728639780968177111213635962814108286690465242000"),
                BigInteger.Parse("1622785442121686247049206834643305076505863737401880490815267276779650422192133464088714672320279734375102274682218511217040000"),
                BigInteger.Parse("164493665288141115310201284999269166047953620114080852148343307185214164297893246120537584984266338225118654924157295329112000"),
                BigInteger.Parse("15741402745220199743711152499013526487778483066818945987598917778642346115703919868985379444644564290896801815395073843964800"),
                BigInteger.Parse("1420365069814144797723829822301840281692568826196614095509889798530210239538890922249968154537452189868219047431657319767200"),
                BigInteger.Parse("120681301193061102895060619705509677636360751467169078310470020447734600981467981411418336019335366776947392776025379408000"),
                BigInteger.Parse("9641547369034362522385526805046649110008440784650547209146113205608590051497112583816643918326431489889845158389912840000"),
                BigInteger.Parse("723206806563712969477407822782389404839634861426150519302377090581027671654012540191648569132857734041663632744815344000"),
                BigInteger.Parse("50849288664711222811254190452629899495808861080736193484838609038474308742023585178703033995624598841904990155128304900"),
                BigInteger.Parse("3345513261936845069811840540826682640104345002492940105313766309071803724770600642160773721763123747370837587015209600"),
                BigInteger.Parse("205585133901040651597320384568714683376795476796971407903679780863269803275002695268918637180586767717022471617592000"),
                BigInteger.Parse("11776298488472878546517517972136784560632255064145920740445643431012615684517295136064371728576793784261584607280000"),
                BigInteger.Parse("627460913949504290809848774826633612965186825828047560324078835242333515628812417601687136351527561924314274645600"),
                BigInteger.Parse("31026067420917309458981191006785479078928009289313243887338796319316872642826340801046692276147991701487187669120"),
                BigInteger.Parse("1420206062879060207586916596454381949490138490166036931499755147132242092307871435805006407286565519647148873280"),
                BigInteger.Parse("60019857499783305826316464512272054185576386144366163855050190905898385236086467189355138129380270703395568000"),
                BigInteger.Parse("2335035443563358073794967168520509579638701501554313898442161237732056455231333405169790575505870916805350000"),
                BigInteger.Parse("83362791695645306498390643704576247447453878079844942772271833912401243878974756618291135309061507597840000"),
                BigInteger.Parse("2721646405059020653840518509853269195557042999996205079587839563110778451029757052550042237905979911025600"),
                BigInteger.Parse("80952532299861746161037423296352502647346089552945011277698130777132650603405788350366042613579593750400"),
                BigInteger.Parse("2184565819457466649284922250826713780004434458803250271466597142953520966275196409138733480032621652000"),
                BigInteger.Parse("53241021072976595587559317810459263361647417602414484288317157503177191693520495000991936245031120000"),
                BigInteger.Parse("1165921828391986190790603764234988229836651506054430297638978743801582682120609909076429289278984000"),
                BigInteger.Parse("22812796418778881668811276799701022673180175395697781180075990363689250917496679082336272946083200"),
                BigInteger.Parse("396298724441587454483219383676866366219856864847934678639091593867402546927881673880254659901800"),
                BigInteger.Parse("6068767847107655213557479823897029747103588412169741819498817803740709313454778687913634448000"),
                BigInteger.Parse("81262545110704948463436039670228132300482298398943304344570513180591761002910293925287160000"),
                BigInteger.Parse("942671752391028293809932006741681153060819610661032252537908949019074534533441896862768000"),
                BigInteger.Parse("9372404593652608230101791338158741896985144059848109212357991109064496098116708539519200"),
                BigInteger.Parse("78871029787280469327116324496026959856481074914207060380970559087924527328592683548800"),
                BigInteger.Parse("553498437132920706965710319311478593738183124915334520699960808068923211601242152000"),
                BigInteger.Parse("3182033486983967798654831714001999192137080968397736934115466185163683613944560000"),
                BigInteger.Parse("14662410271218043055318627875239460251377940504234467496427330529984318822226000"),
                BigInteger.Parse("52692932886218732911983484311100939215049947591265227197683650986009817513600"),
                BigInteger.Parse("142579564748495285592639244581432319156482425879123347236870383444513534400"),
                BigInteger.Parse("277122195718557530350544858128932074322870968399082809651132892604848000"),
                BigInteger.Parse("362086715210781794323864415752041455842004484725853427862710661220000"),
                BigInteger.Parse("287643495581862234166644513335889055582086887577562882364035259520"),
                BigInteger.Parse("117031895717623830270793634313622270891697002607808248859157824"),
                BigInteger.Parse("16850913260983903715523324194883883640143170399517281539456"),
                BigInteger.Parse("104326219460917277964091790659689347988584942875383375"),
                BigInteger.Parse("38516631450260400525535211315498342335386604779997217684530295319307159303730348323765465398634998010522717296836706943829383440000"),
                BigInteger.Parse("2455397493550717925267060373116631580408018224720136355606762669453557575064472715102476100079256971211989381872068659132903753728000"),
                BigInteger.Parse("77345021046847614645912401753173894782852574078684295201613024087787063614530890525727997152496594593177665528970162762686468242432000"),
                BigInteger.Parse("1604985614608497932375652605550051176324015865269140513076950104588466735084139032648505869765245539977006893387720768790924736256000000"),
                BigInteger.Parse("24679838319872736063316086692485905985141116975864759873703101806667891263694598220289524783096533600836911555069118964542989496000000000"),
                BigInteger.Parse("299933780123266111902547373891470149868822562642142882544796580681512890481171324347295483658795482454155039870847970077457908998400000000"),
                BigInteger.Parse("3000537536353154183473083928410267379287700916671997396978144993137854956373637928770344018522590006471367018867963092654888921619993600000"),
                BigInteger.Parse("25412469943571578919351500258859648337948962095187622245663440268904770433727850318134147103517196600992725147750356381968715009153382400000"),
                BigInteger.Parse("185982390917671031204124891007380087634586154043409412805964290677669993295226001320215633035821418672587887674060067876101684441989472000000"),
                BigInteger.Parse("1194704697392866543227576897699229712740391488861847240157071556849809943434920062461844012483819099705152962656580193104242939195505920000000"),
                BigInteger.Parse("6819529821459606504065705202232757571666901336015471116376259675319118384436238828085046188332434064251934106351097183564950956172070784000000"),
                BigInteger.Parse("34935224013013479552924351028580872368991925730994283574282241587182095887022899169032336800043630683139963737396381341854438924271469107200000"),
                BigInteger.Parse("161933353929173136780153446775921994464466672138338257059480390307798977246815159672850708692005517633734831913915193842776108292422260492800000"),
                BigInteger.Parse("683821127386884977729422912311110923126301173259079566056811778001278365455053570761579124391058437870852376616533297202479672244670134528000000"),
                BigInteger.Parse("2646072898477586203669638246870916234411395626158953102421724442029740074119171284735626422894562019033906333365629140001330727015237740160000000"),
                BigInteger.Parse("9429242345280294737392055296318435112500027235457713379086211414170708612670308295979070423161202746665223066781752304701837462077535980288000000"),
                BigInteger.Parse("31077211229652971405321315580782842391614673096862713678571638452537627135925891092164352936335464052550797690934858637579805968763879001699200000"),
                BigInteger.Parse("95090300272470032121819984075877995720539900551365310473050113030260344709286408579322479868206371917625281046936294014863930052589845864908800000"),
                BigInteger.Parse("271020673745765427686139590468363755309942153532252670605962156885966108520165044060113790660784267300234519510525711933120584953809994867072000000"),
                BigInteger.Parse("721638436200694532080127401669038735546570379935978130261045139032363677805191845054577914728581693299980432807284762620056809592756348757760000000"),
                BigInteger.Parse("1799815184524274582976114358569475422638607311992867489286657495061225681170067457623409155123911799476137638772744963043073890365662656266176000000"),
                BigInteger.Parse("4214521635737085528038901221404023907601164356107310376128999799985313874691246107456153231329670669654761206414962673338553571847132250417817600000"),
                BigInteger.Parse("9285373813622770796234890764017956324788734678898429348495554726385670156710977729364353137090350570167890754304294219309610452970119266557670400000"),
                BigInteger.Parse("19284607304650389804458730024915068836517749015887202584205173372769641508526438165296743873076245912664419499049597809463699261346786235638528000000"),
                BigInteger.Parse("37821104843172100694089319660932570347480930182020160240574801226768046924049695539698355440731430561475477896842961221146479154796498867308320000000"),
                BigInteger.Parse("70154056290919401322092604711326353863587138373991334458361432162967847385354171189826629174219062194722999001035809627865122892845038245299865600000"),
                BigInteger.Parse("123250587858260740851154666404213156135593056146681096959790168278284315155607177678983037810091215287250807275063915710761033630807687592829496320000"),
                BigInteger.Parse("205357845077761952490473131699208140790697018344348804929606714152172895800269310116267710742286867198650787085186553396775055549827073844627118080000"),
                BigInteger.Parse("324892580715130908545391389436403856827387200074862614315323905535235941037393488749107750391149335636963181322115317873970560941925665073736512000000"),
                BigInteger.Parse("488597379474372777548135311472033750963258891195676725159001468145045695924380303602638117708093334772282469252459615213779212110749519099193600000000"),
                BigInteger.Parse("699169878415982992296756458982547411776627988551689614674429534504901672840462788429615784366360108253788276797546192743965474321311479985306240000000"),
                BigInteger.Parse("952875822827574813587522136069977877612706187694962218938369484588329075558629285564434071137866550402940696664870839888764989089374470070296934400000"),
                BigInteger.Parse("1237887787691179780151647060698051617791506699193008954067256785782159647265897866514510333487139134675248851470881314319779517075928441028823249600000"),
                BigInteger.Parse("1534112871822742165373423181623349742391431049957907550087427895955061283199482068570775138116960036450369550946383691615217990995035654597481728000000"),
                BigInteger.Parse("1815001052646672964597862879159580445092140868590900161934384089941533818093716861729865127634400255100927409903445464510320172176161684625796480000000"),
                BigInteger.Parse("2051291428860661287202911091094124402197219841399049672350405392924226068232097324530378919945691923735269220087384647802096825489852029346957056000000"),
                BigInteger.Parse("2216016346632805299660114557500167725403966283208367297554301583568141191893159685439636621092845972156434778670159475580143994809491662006636940800000"),
                BigInteger.Parse("2289582729113889419814202033245884758371221241888245219687105128672402574173705156917269874341516287658110819082632991429959956132921657943917619200000"),
                BigInteger.Parse("2263602432573968414809067437504079692305685897038233745682929865261585838059228058323568357177332013027514197040893795245216325534600238841222272000000"),
                BigInteger.Parse("2142438317962600378426164501288866635397441100706162389568742552374489254738794369274699579462416332783928715384326988055557458056498630877725440000000"),
                BigInteger.Parse("1942080660449431268962236154409074477827865590362345351284999035902430537397481192148084155827505175736542789223385297505917362441955703360456672000000"),
                BigInteger.Parse("1686735058014843538874064662297887033720945996575622916555638413938628269349417584468035427908721454956207781542171053625105312178742242192587212800000"),
                BigInteger.Parse("1404111226531715549383149955864796482676915659365688769656128906663197230893674050621922682644977072316682979694984849045731858669487033387287219200000"),
                BigInteger.Parse("1120652152630946682606269917826363389929932685878718736345267202501143329821242200026886648120404236121296274873931569660912751050764298947600128000000"),
                BigInteger.Parse("857789061940926170005228046020608340919781236832552720573028283218070687706225268888504574140189348832124292731547106279901055156781420935448640000000"),
                BigInteger.Parse("629858382290904397817424953855258699620085811816383103510811289162336896754902851468209993776240141132972150492295568718638247135658774803785984000000"),
                BigInteger.Parse("443769787771417736184823419869450384018043895985745693840018802695534670736425342349134287540485548711284519280596650175885290890817145063619814400000"),
                BigInteger.Parse("300063008284409712281339423269152952320864049387898085970213263514582233842139583007528243697842310347180268457876712864525104560399824647517337600000"),
                BigInteger.Parse("194752433261515919028753952602575233477483878208491546182590339300329815234080979355847658169272653350333347316410366522648505363721040035648272000000"),
                BigInteger.Parse("121348257735658149291306810652496842707058869198231940439117711168104548188838784336878359423228154310766711529105148025548511672948533276673280000000"),
                BigInteger.Parse("72596889724963642323595394877736460656397742912573322037460518079403905431031513503285869006401154064363541402169507003245624167835811849598131200000"),
                BigInteger.Parse("41704153006994895819752648649993800354120023331699222587947190012902903492948375906335239526776215333387606854273558972883139048495637108434851840000"),
                BigInteger.Parse("23006476564567697052902762056915886092789439718806924074723506406062197515152139498856883645427452123961564414706718241828066526375986836214248960000"),
                BigInteger.Parse("12188578531279475155827283550926717234770871493372940535916347849665817068163137386698042269628820253423265839188427732913837642935507478987008000000"),
                BigInteger.Parse("6201559483736806666193749881522119605150195891842667764423884356953179751403136459128541858859548258754961991886301239243839284771916621596800000000"),
                BigInteger.Parse("3030377596666325609297027305290139313163397395543563207907537159318053099690614486857746098738966955567101282692880985472204415770049171403520000000"),
                BigInteger.Parse("1422112915006982803791533528268301091963108634908657876853751366908543490354809798475385133479643778433989673378016291039455929400658789722937600000"),
                BigInteger.Parse("640909919907934064443473454686375313595645891003531611255962001907473712659242501084913056717617825562422217253673567821008437899688594998118400000"),
                BigInteger.Parse("277370454714597030676076547352079877095990950739076289441146913051214241720344412259841335065008759408327971068509024039569134131091285017472000000"),
                BigInteger.Parse("115262780372666579898946031464384909780059906398497675126967184895239162652435989952252744417447501328591938420450708604587362802475342565120000000"),
                BigInteger.Parse("45987497067053706878048875818953571146942268777359786708820580912284196527655583746255941905328543897428008084077782718769039648742713207104000000"),
                BigInteger.Parse("17614042592475551789524226837423494757920889159281310487211985425503724201765350109116609610817725598712232436406757298588629225697503267891200000"),
                BigInteger.Parse("6475664810768780346963429587220376938770050869832221065385051509110198571683270550591423985619885483663575975539630925703268908882138298188800000"),
                BigInteger.Parse("2284776876239663433544955418140917597444158091255878638909603665933280028992617045977235701810124905413006080686324259500536525956441590528000000"),
                BigInteger.Parse("773492171643636058231365115516456478301407687143917247547522074404495843148542229106876669883636035686694766899016025351744136391503663460000000"),
                BigInteger.Parse("251205834560381843478764731837483086629985968148552101660218204107847542454685643798544239466034675464257213059752929055032811754373159168000000"),
                BigInteger.Parse("78246410669286401963959732261340425548383189121869578076938780322587918726315958905670956886310322357527007512870409959247062417271256755200000"),
                BigInteger.Parse("23369495787036339905843457901949734614545148958296670953722061689965056354965407611249116239755637617955235127037502208471325125335220172800000"),
                BigInteger.Parse("6690578424636499065659187728499376461923908415782682704210164720374851866330834782319443479154070219158022572352726696104900653842843072000000"),
                BigInteger.Parse("1835592313664512647634931764619684776812418491193574887460589251346739177463470133256671310253848606976625583672684841061098063597896960000000"),
                BigInteger.Parse("482442158015358086037383755647354939036259299298342032633651030576692892878647833794495332080543005612443375370808565753538984149923456000000"),
                BigInteger.Parse("121427771176153318038796398642569884160934392347188333451606418506779345554382165095135254500059016106184834333908878445466302367692953600000"),
                BigInteger.Parse("29257053562370274092681016339604700350370061924231971646854445038771110432487007169661211682079436851671345953641088466027206911056454400000"),
                BigInteger.Parse("6745394488517137825096004964891270086019896004688559972476359811319336786590312305004606031948848379605340634569545061409072332214528000000"),
                BigInteger.Parse("1487512743606764132798866553736788844333166849860782827313245369737038183559045704326082559762999679791198521285383786188368341749120000000"),
                BigInteger.Parse("313610421525050382914943357406606974031788104920925263482173719940140204887365657884438179450586009838851577747238924204133347630643200000"),
                BigInteger.Parse("63180579073321553750992974635424621376579533418279972672285875157531169931986824059174826210951392040634133645569479174458443426173440000"),
                BigInteger.Parse("12156634673325746248830687711902060211179635973683413446049636575329947229168472568013613807693759826725801525651183252605658562447360000"),
                BigInteger.Parse("2232744051928885979149975055124622121759440487819987344239885715002259106480812809596277384731999968175654990666271772842439450752000000"),
                BigInteger.Parse("391205244026730361790562746553337924501940155557388900335244225256063420644925365337258069984509756277648196176240137557317932800000000"),
                BigInteger.Parse("65349057809010639980923549708341676024755912348791100396910114900728775948640941709746518508776061560016232770349204796506518320000000"),
                BigInteger.Parse("10400527295740952648815769181094802194839459489162096825074371725999585082196399611794578183830602813361313659958222646978391910400000"),
                BigInteger.Parse("1575970003742075948047357230833120433504549440395882627965432553378967125575316509721045558833877437796969451417835531452711193600000"),
                BigInteger.Parse("227192555731325107072778707975803279988468371169265063018904198446581374047002240763462936610218420240944826550241628950979328000000"),
                BigInteger.Parse("31135192438262992248345919282398290031642260168545461294118930850237480662587516383697163239772457923385295997333778053913280000000"),
                BigInteger.Parse("4052823123026734181896833799951672840720134588158790008150878374176079354221918197313727750233883067839351911039250641761536000000"),
                BigInteger.Parse("500642856373890693057844175288147821500722507949027001006873210927633331992119306726989898558303202497802294893083902805836800000"),
                BigInteger.Parse("58634768324548716142665283945194215372661644473115996445204085507541630802586509296325688996626410576155584017267937198643200000"),
                BigInteger.Parse("6504398001370393295046744160587020644694608829539382722546990004895040213490386583196302080253470870190419222694765760672000000"),
                BigInteger.Parse("682692651694665514382891804515626199671909424347805762441855911164385570412770172225407471250448399212612123218989072640000000"),
                BigInteger.Parse("67720917658065213675732640849542036674281778238517278443027473918716158992752703831195038312795483777315339130558353792000000"),
                BigInteger.Parse("6341365982500145882656016852111628608993684995228457774951490398249411891029657115328686238281082263796561226611058636800000"),
                BigInteger.Parse("559828969292828361326737436838062652914871978634961940365547800269632598015078425080713816900212193489993342646204275200000"),
                BigInteger.Parse("46532390085689276025574851270925453042597710474309126252430254524687451250016413721333822105301627006886444470889728000000"),
                BigInteger.Parse("3636297885603509224483456331258293217802158882612809314446546026029555226393454972970005798877655380758790971917440000000"),
                BigInteger.Parse("266749017825899794041872376833723765307226038986045900674012725806156323243769629269195587207631862517905424680704000000"),
                BigInteger.Parse("18338994975530610840378725907318508864871790180290655671338374899173247223009162012257196620524690548105997946798400000"),
                BigInteger.Parse("1179555405286025154227821831035463969004267383702802984242214089345773276614477644826501915811482397958967124633600000"),
                BigInteger.Parse("70846456142857362014458428239665557425340265231439342246529262664141639579660566371005346273874879236750156672000000"),
                BigInteger.Parse("3965541841619115032656426209130092965324971418088671926557322171897524701428597615825429534727603740331508480000000"),
                BigInteger.Parse("206411536884277013238270389859848428707940819967179590023368307921845516510257773336554409115308604945460569600000"),
                BigInteger.Parse("9967877475855216991896034157396704701577978913777564360119223301751211145433080590382314486820396380630353920000"),
                BigInteger.Parse("445470460150901599714223069677392838076632365512595504252845350001868488928827513015557981267374475375764480000"),
                BigInteger.Parse("18373995754685325199203312094060875991484931631650934562113679643455455156021186843080949795278470016768000000"),
                BigInteger.Parse("697393563563461229726846359845427985506766129743836079027594116021841668371249500623011758424030997600000000"),
                BigInteger.Parse("24280116498708962397301746492253311132118253145291549392824468750807732635820228593119047029332394240000000"),
                BigInteger.Parse("772687984172750627234885768872967008355461389403617861180451647038283818473272683529448918040389401600000"),
                BigInteger.Parse("22391133957712525232548279823076632870866409201810917133874970892033313939324592598043367003365734400000"),
                BigInteger.Parse("588355622011965753107499845200962575435678920468004579343561547463337828736006562260899283121472000000"),
                BigInteger.Parse("13953388027494663058157020606401159499816388302929647391284615118022116639810428362924653784320000000"),
                BigInteger.Parse("297139396351380745074078521008044616994844632602860486165587694294119793948640504366141444224000000"),
                BigInteger.Parse("5649248542002019757233179709752199614813448746596788366987874150605819008902391695311542835200000"),
                BigInteger.Parse("95275025013922952254924657803360509376814115766017264125787560079661630110457002797912924800000"),
                BigInteger.Parse("1415063184809796926863167143561267544429444135394773401212266502823119699641665986230528000000"),
                BigInteger.Parse("18357009439711969028988454419808882155311543639294688303346674425059002775188402341760000000"),
                BigInteger.Parse("206042289116717752900147931199828341182035210752490488511199182569271569847936430848000000"),
                BigInteger.Parse("1979223959495564621454622984431848597561421975208652475846494610887091434499881971200000"),
                BigInteger.Parse("16064536841506150773658625957388182677126465026596699674828585662983217693782476800000"),
                BigInteger.Parse("108517505070355968134515405017974704893386830810957809151998552132654995475072000000"),
                BigInteger.Parse("599066150790163597626595500927297027565774076733497075610615818679933116160000000"),
                BigInteger.Parse("2642938900544839401293803680561604533378415044412487098282128611823234336000000"),
                BigInteger.Parse("9060580252862626658858463796232008195236684572212995255818745164499609600000"),
                BigInteger.Parse("23277732482274915565944181517111839013943035969717751452433771526118400000"),
                BigInteger.Parse("42687937799880644720235066050085895862723337556790301581576694528000000"),
                BigInteger.Parse("52160236803373221798918702407240830721802709624621580622649920000000"),
                BigInteger.Parse("38224295672700986967146530008359692742695115450104364425758720000"),
                BigInteger.Parse("14001573506483878009943783885846041297690518479891708580864000"),
                BigInteger.Parse("1709280779647668682163679898168350277444975704070281216000")

            }
        );

        public static MultiPrecision<N> Log1pC32(MultiPrecision<N> x) {
            const int n = 32;

            MultiPrecision<N> sc = n32[n - 1], sd = n32[2 * n - 1];

            for (int i = n - 2; i >= 0; i--) {
                sc = n32[i] + x * sc;
                sd = n32[i + n] + x * sd;
            }

            MultiPrecision<N> y = x * sc / sd;

            return y;
        }

        public static MultiPrecision<N> Log1pC128(MultiPrecision<N> x) {
            const int n = 128;

            MultiPrecision<N> sc = n128[n - 1], sd = n128[2 * n - 1];

            for (int i = n - 2; i >= 0; i--) {
                sc = n128[i] + x * sc;
                sd = n128[i + n] + x * sd;
            }

            MultiPrecision<N> y = x * sc / sd;

            return y;
        }
    }
}
